+++
title = "Интеграция Remark42: комментарии и виджет последних событий"
description = "История о том, как я подключал систему комментариев Remark42 к блогу на Hugo, боролся с кросс-доменными куками и добавлял виджет последних комментариев в сайдбар."
date = "2026-01-13T02:00:00Z"
draft = false
tags = ['IT', 'Hugo', 'Remark42']
+++

Сегодня я завершил интеграцию системы комментариев **Remark42** в этот блог. Процесс оказался интересным и потребовал решения нескольких технических нюансов, о которых стоит рассказать.

### Почему Remark42?
Remark42 — это легкий и функциональный движок для комментариев, который не следит за пользователями, поддерживает авторизацию через соцсети и отлично вписывается в концепцию статического сайта.

### Трудности перевода (и авторизации)
Сначала всё шло гладко: тема **Stack** имеет встроенную поддержку Remark42. Однако после включения я столкнулся с тем, что авторизация через GitHub открывала окно, которое тут же закрывалось без результата.

Оказалось, что проблема в **Cross-Domain Cookies**. Так как сам блог живет на одном домене, а сервер Remark42 на другом, современные браузеры блокируют куки авторизации. Решение нашлось в настройках сервера:
1. Установка `AUTH_SAME_SITE=none` для разрешения передачи кук между доменами.
2. Настройка `ALLOWED_HOSTS` для явного разрешения запросов с домена блога.

### Виджет последних комментариев
Одной из интересных задач стала установка виджета "Последние комментарии" прямо в сайдбар. В теме Stack нет готового виджета для этого, поэтому пришлось:
- Создать новый партиал для виджета.
- Вынести скрипт инициализации Remark42 в глобальный футер, чтобы виджет работал не только на страницах постов, но и на главной.
- Добавить переводы для заголовка виджета.

Теперь в правой колонке (после поиска) вы можете видеть ленту последних обсуждений. 

### Итог
Блог стал чуточку более живым. Теперь под каждым постом можно оставить свое мнение или задать вопрос. Весь процесс интеграции занял пару вечеров, но результат того стоит!
